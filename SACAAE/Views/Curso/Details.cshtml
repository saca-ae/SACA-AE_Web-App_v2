@model SACAAE.Models.Curso

@{
    ViewBag.Title = "Details";
    Layout = "~/Views/Shared/Privado.cshtml";
}



<style type="text/css">
    body {
        margin-left: 10px;
    }

    p {
        margin-left: 20px;
    }

    h3 {
        margin-top: 30px;
    }

    .header {
        padding: 10px;
        margin-top: 2%;
    }

    hr {
        margin-top: 0px;
    }

    .detalles {
        width: 100%;
        margin-right: 100px;
    }

    .detalle_1, .detalle_2 {
        margin-left: 50px;
        float: left;
    }

        .detalle_1 th, .detalle_2 th {
            border: 2px solid #4800ff;
            background-color: #808080;
            width: 150px;
        }

        .detalle_1 td, .detalle_2 td {
            border: 2px solid #4800ff;
            background-color: #93939B;
            width: 250px;
        }
</style>

<script type="text/javascript">
    window.onload = function()
    {
        var route = "/CursoProfesor/Cursos/" + obtener_id();
        generar_tabla(route);
        
    };

    function obtener_id()
    {
        var url = window.location.pathname.split('/');
        return url[3];
    }

    function ver_detalle_grupo(id_grupo)
    {
        var route_temporal = "/Curso/DetalleAsignacion/" + id_grupo;
        window.location = route_temporal;
    }

    function editar_asignacion_grupo(id_grupo) {
       
        var route_temporal = "/Curso/EditarAsignacion/" + id_grupo;
        window.location = route_temporal;
    }

    function eliminar_asignacion_grupo(id_grupo) 
    {
        var route_temporal = "/Cursos/Grupo/EliminarGrupo/"+ id_grupo;
        $.getJSON(route_temporal, function (data) {
            if (data.respuesta = 'success') {
                var route = "/CursoProfesor/Cursos/" + obtener_id();
                alert('El profesor fue removido del grupo exitosamente');
                document.getElementById('tabla_grupos').innerHTML = "";
                generar_tabla(route);

            }
            else
            {
                alert('Error');
            }
        });
    }

    function generar_tabla(route)
    {
        var tabla = "<table id=\"profesores_asignados_a_curso\" class=\"table\">" +
            "<thead>" +
                "<th>Grupo</th>" +
                "<th>Nombre Profesor</th>" +
                "<th>Inicio</th>" +
                "<th>Fin</th>" +
                "<th>Aula</th>" +
                "<th>Dia</th>" +
                "<th>Acciones</th>" +
            "</thead>" +
            "<tbody>";
        $.getJSON(route, function (data) {

            if (data.length != 0) {
                for (i = 0; i < data.length; i++) {
                    if (data[i + 1] != undefined) {
                        if (data[i].ID == data[i + 1].ID) {
                            tabla = tabla + "<tr>" +
                            "<td rowspan=\"2\">" + data[i].Number + "</td>" +
                            "<td rowspan=\"2\">" + data[i].Name + "</td>" +
                            "<td>" + data[i].StartHour + "</td>" +
                            "<td>" + data[i].EndHour + "</td>" +
                            "<td>" + data[i].Code + "</td>" +
                            "<td>" + data[i].Day + "</td>" +
                            "<td rowspan=\"2\">" +
                                /*<!-- Esteban Segura Benavides
                                Agregacion de opcion ver detalle de asignaion
                                RECORDAR AGREGAR ESTAS FUNCIONALIDADES *****************************************-->*/

                                    "<a onclick=ver_detalle_grupo(" + data[i].ID + ") title=\"Ver Detalle Curso\"><span class=\"glyphicon glyphicon-eye-open\" aria-hidden=\"true\"></span></a> &nbsp" +
                                    "<a onclick=editar_asignacion_grupo(" + data[i].ID + ") title=\"Editar\"><span class=\"glyphicon glyphicon-pencil\" aria-hidden=\"true\"></span></a> &nbsp" +
                                    "<a onclick=eliminar_asignacion_grupo(" + data[i].ID + ") title=\"Eliminar\"><span class=\"glyphicon  glyphicon-trash\" aria-hidden=\"true\"></span></a>" +
                             "</td> " +
                                 "</tr>" +

                                 "<tr>" +
                                     "<td>" + data[i + 1].StartHour + "</td>" +
                                     "<td>" + data[i + 1].EndHour + "</td>" +
                                     "<td>" + data[i + 1].Code + "</td>" +
                                     "<td>" + data[i + 1].Day + "</td>" +

                                 "</tr>";
                            i++;
                        }
                        else {

                            tabla = tabla + "<tr>" +
                            "<td>" + data[i].Number + "</td>" +
                            "<td>" + data[i].Name + "</td>" +
                            "<td>" + data[i].StartHour + "</td>" +
                            "<td>" + data[i].EndHour + "</td>" +
                            "<td>" + data[i].Code + "</td>" +
                            "<td>" + data[i].Day + "</td>" +
                            "<td>" +
                                /*<!-- Esteban Segura Benavides
                                Agregacion de opcion ver detalle de asignaion
                                RECORDAR AGREGAR ESTAS FUNCIONALIDADES *****************************************-->*/
                                    //"<a title=\"Ver Detalle Curso\"><span class=\"glyphicon glyphicon-eye-open\" aria-hidden=\"true\"></span></a> &nbsp" +
                                    "<a title=\"Editar\"><span class=\"glyphicon glyphicon-pencil\" aria-hidden=\"true\"></span></a> &nbsp" +
                                    " <a title=\"Eliminar\"><span class=\"glyphicon  glyphicon-trash\" aria-hidden=\"true\"></span></a>" +
                                "</td> " +
                            "</tr>";

                        }
                    }
                    else {

                        tabla = tabla + "<tr>" +
                        "<td>" + data[i].Number + "</td>" +
                        "<td>" + data[i].Name + "</td>" +
                        "<td>" + data[i].StartHour + "</td>" +
                        "<td>" + data[i].EndHour + "</td>" +
                        "<td>" + data[i].Code + "</td>" +
                        "<td>" + data[i].Day + "</td>" +
                        "<td>" +
                            /*<!-- Esteban Segura Benavides
                            Agregacion de opcion ver detalle de asignaion
                            RECORDAR AGREGAR ESTAS FUNCIONALIDADES *****************************************-->*/
                                //"<a title=\"Ver Detalle Curso\"><span class=\"glyphicon glyphicon-eye-open\" aria-hidden=\"true\"></span></a> &nbsp" +
                                "<a title=\"Editar\"><span class=\"glyphicon glyphicon-pencil\" aria-hidden=\"true\"></span></a> &nbsp" +
                                " <a title=\"Eliminar\"><span class=\"glyphicon  glyphicon-trash\" aria-hidden=\"true\"></span></a>" +
                            "</td> " +
                        "</tr>";

                    }
                };
                tabla = tabla + "</tbody> </table>";

                document.getElementById('tabla_grupos').innerHTML = tabla;
            }
            else {
                /*Sin Profesores asignados*/
                //document.getElementById('tabla_grupos').innerHTML = "<p> Sin profesores asignados</p>";
            }

        });
    }
</script>
<div class="header">
    <h2>Detalle del Curso</h2>
    <hr />
</div>


<div class="detalles">


    <div class="detalle_1">
        <table id="tbl_detalle_1">

            <tbody>
                <tr>
                    <th>Nombre</th>
                    <td>@Html.DisplayFor(model => model.Name)</td>
                </tr>

                <tr>
                    <th>Codigo</th>
                    <td>@Html.DisplayFor(model => model.Code)</td>
                </tr>
                <tr>
                    <th>Horas Teoricas</th>
                    <td>@Html.DisplayFor(model => model.TheoreticalHours) </td>
                </tr>
                <tr>
                    <th>Bloque</th>
                    <td>@Html.DisplayFor(model => model.Block) </td>
                </tr>
            </tbody>

        </table>
    </div>

    <div class="detalle_2">
        <table id="tbl_detalle_2">
            <tbody>
                <tr>
                    <th>Horas Practicas</th>
                    <td>@Html.DisplayFor(model => model.PracticeHours)</td>
                </tr>
                <tr>
                    <th>Creditos</th>
                    <td>@Html.DisplayFor(model => model.Credits)</td>
                </tr>
                <tr>
                    <th>Externo</th>
                    <td>@Html.DisplayFor(model => model.External) </td>
                </tr>
                <tr>
                    <th><br /> </th>
                    <td><br /> </td>
                </tr>
            </tbody>

        </table>
    </div>
</div>
<br /><br /><br /><br /><br /><br />
<h3>Grupos</h3>
<p>
    <a href="@Url.Action("AsignarProfesoraCurso", new { id = Model.ID })"> <span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span> Asignar Profesor</a>
</p>
<div id="tabla_grupos">

    


</div>
<p>
    @Html.ActionLink("Edit", "Edit", new { id = Model.ID }) |
    @Html.ActionLink("Back to List", "Index")
</p>
